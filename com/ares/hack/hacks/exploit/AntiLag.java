package com.ares.hack.hacks.exploit;

import net.minecraft.util.text.ITextComponent;
import java.awt.event.ActionEvent;
import java.util.Iterator;
import net.minecraft.util.text.TextComponentString;
import net.minecraft.tileentity.TileEntitySign;
import net.minecraft.tileentity.TileEntity;
import net.minecraft.block.Block;
import net.minecraftforge.fml.common.eventhandler.Event;
import net.minecraft.block.BlockPistonExtension;
import net.minecraft.block.BlockPistonMoving;
import com.ares.event.world.RenderBlockSide;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraft.network.play.server.SPacketSoundEffect;
import com.ares.event.packet.PacketRecieved;
import java.util.HashSet;
import com.ares.hack.settings.settings.BooleanSetting;
import net.minecraft.util.SoundEvent;
import java.util.Set;
import com.ares.hack.settings.Setting;
import javax.swing.Timer;
import com.ares.hack.categories.EnumCategory;
import com.ares.hack.hacks.BaseHack;

@Hack(name = "Anti Lag", description = "Prevents lag exploits", category = EnumCategory.EXPLOIT)
public class AntiLag extends BaseHack
{
    private final Timer resetTimer;
    private final Setting<Boolean> antiSound;
    private final Setting<Boolean> antiPiston;
    private final Setting<Boolean> antiSign;
    private final Set<SoundEvent> blacklistedSounds;
    
    public AntiLag() {
        this.antiSound = new BooleanSetting("Anti Sound", this, true);
        this.antiPiston = new BooleanSetting("Anti Piston", this, true);
        this.antiSign = new BooleanSetting("Anti Sign", this, false);
        this.blacklistedSounds = new HashSet<SoundEvent>();
        this.resetTimer = new Timer(500, a1 -> this.blacklistedSounds.clear());
    }
    
    public void onEnabled() {
        try {
            /*SL:54*/this.resetTimer.start();
        }
        catch (Exception ex) {}
    }
    
    public void onDisabled() {
        try {
            /*SL:63*/this.resetTimer.stop();
        }
        catch (Exception ex) {}
    }
    
    @SubscribeEvent
    public void onPacketRecieved(final PacketRecieved v2) {
        /*SL:70*/if (this.getEnabled() && this.antiSound.getValue() && v2.packet instanceof SPacketSoundEffect) {
            final SPacketSoundEffect a1 = /*EL:72*/(SPacketSoundEffect)v2.packet;
            /*SL:74*/if (this.blacklistedSounds.contains(a1.func_186978_a())) {
                /*SL:76*/v2.setCanceled(true);
            }
            else {
                /*SL:80*/this.blacklistedSounds.add(a1.func_186978_a());
            }
        }
    }
    
    @SubscribeEvent
    public void onLighting(final RenderBlockSide v2) {
        /*SL:88*/if (this.getEnabled() && this.antiPiston.getValue()) {
            final Block a1 = /*EL:90*/v2.state.func_177230_c();
            /*SL:91*/if (a1 instanceof BlockPistonMoving || a1 instanceof BlockPistonExtension) {
                /*SL:93*/v2.setCanceled(true);
                /*SL:94*/v2.setResult(Event.Result.DENY);
            }
        }
    }
    
    public void onRender3d() {
        /*SL:102*/if (this.getEnabled() && this.antiSign.getValue()) {
            /*SL:104*/for (final TileEntity tileEntity : AntiLag.mc.field_71441_e.field_147482_g) {
                /*SL:106*/if (tileEntity instanceof TileEntitySign) {
                    final TileEntitySign tileEntitySign = /*EL:108*/(TileEntitySign)tileEntity;
                    final String[] v0 = /*EL:110*/{ "Buy", "Ares", "Client", "Now" };
                    /*SL:113*/for (int v = 0; v < tileEntitySign.field_145915_a.length; ++v) {
                        /*SL:115*/tileEntitySign.field_145915_a[v] = (ITextComponent)new TextComponentString(v0[v]);
                    }
                }
            }
        }
    }
}
