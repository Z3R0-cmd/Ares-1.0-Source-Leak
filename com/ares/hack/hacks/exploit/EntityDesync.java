package com.ares.hack.hacks.exploit;

import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraftforge.event.world.WorldEvent;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.CPacketVehicleMove;
import com.ares.utils.chat.ChatUtils;
import net.minecraft.entity.Entity;
import com.ares.hack.categories.EnumCategory;
import com.ares.hack.hacks.BaseHack;

@Hack(name = "Entity Desync", description = "Dismount entities", category = EnumCategory.EXPLOIT)
public class EntityDesync extends BaseHack
{
    private Entity dismountedEntity;
    
    public EntityDesync() {
        this.dismountedEntity = null;
    }
    
    public void onEnabled() {
        /*SL:20*/if (this.dismountedEntity == null) {
            /*SL:21*/this.dismount();
        }
        else {
            /*SL:23*/this.remount();
        }
    }
    
    public void onDisabled() {
        /*SL:29*/if (this.dismountedEntity == null) {
            /*SL:30*/this.dismount();
        }
        else {
            /*SL:32*/this.remount();
        }
    }
    
    private void dismount() {
        /*SL:37*/if (EntityDesync.mc.field_71439_g.func_184187_bx() != null) {
            /*SL:39*/this.dismountedEntity = EntityDesync.mc.field_71439_g.func_184187_bx();
            EntityDesync.mc.field_71439_g.func_184210_p();
            EntityDesync.mc.field_71441_e.func_72900_e(/*EL:41*/this.dismountedEntity);
        }
    }
    
    private void remount() {
        /*SL:47*/if (this.dismountedEntity == null) {
            /*SL:49*/ChatUtils.printMessage("You didnt dismount an entity", "red");
            /*SL:50*/return;
        }
        /*SL:53*/this.dismountedEntity.field_70128_L = false;
        EntityDesync.mc.field_71441_e.func_72838_d(/*EL:54*/this.dismountedEntity);
        EntityDesync.mc.field_71439_g.func_184220_m(/*EL:55*/this.dismountedEntity);
        /*SL:57*/ChatUtils.printMessage("Remounted Entity", "green");
    }
    
    public void onLogic() {
        /*SL:63*/if (this.dismountedEntity != null) {
            /*SL:65*/this.dismountedEntity.field_70165_t = EntityDesync.mc.field_71439_g.field_70165_t;
            /*SL:66*/this.dismountedEntity.field_70163_u = EntityDesync.mc.field_71439_g.field_70163_u;
            /*SL:67*/this.dismountedEntity.field_70161_v = EntityDesync.mc.field_71439_g.field_70161_v;
            EntityDesync.mc.field_71439_g.field_71174_a.func_147297_a(/*EL:68*/(Packet)new CPacketVehicleMove(this.dismountedEntity));
        }
    }
    
    @SubscribeEvent
    public void onWorldUnload(final WorldEvent.Unload a1) {
        /*SL:75*/this.dismountedEntity = null;
    }
}
