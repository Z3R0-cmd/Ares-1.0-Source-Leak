package com.ares.hack.hacks.exploit;

import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import java.time.temporal.Temporal;
import java.time.Duration;
import net.minecraft.network.play.client.CPacketKeepAlive;
import com.ares.event.packet.PacketSent;
import com.ares.hack.settings.settings.number.IntegerSetting;
import java.time.Instant;
import com.ares.hack.settings.Setting;
import com.ares.hack.categories.EnumCategory;
import com.ares.hack.hacks.BaseHack;

@Hack(name = "Ping Spoof", description = "Spoof your ping retard", category = EnumCategory.EXPLOIT)
public class PingSpoof extends BaseHack
{
    private Setting<Integer> delay;
    private Instant lastSent;
    
    public PingSpoof() {
        this.delay = new IntegerSetting("Delay", this, 20, 1, 300);
        this.lastSent = Instant.now();
    }
    
    @SubscribeEvent
    public void onPacketSent(final PacketSent v2) {
        /*SL:24*/if (v2.packet instanceof CPacketKeepAlive && this.getEnabled()) {
            final Instant a1 = /*EL:26*/Instant.now();
            /*SL:28*/if (Duration.between(this.lastSent, a1).getSeconds() >= this.delay.getValue() / 10.0f) {
                /*SL:30*/this.lastSent = Instant.now();
                /*SL:31*/v2.setCanceled(false);
            }
            else {
                /*SL:35*/v2.setCanceled(true);
            }
        }
    }
}
